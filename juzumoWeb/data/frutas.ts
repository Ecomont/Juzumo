import { Fruit } from '@/lib/types';

// Nota: la ruta de detalle será /fruta/${_id}
export const FRUTAS: Fruit[] = [
  {
    _id: 'manzana.jpg-golden',
    nombre: 'manzana.jpg Golden',
    precio: 1.99,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-24',
  },
  {
    _id: 'naranja-valencia',
    nombre: 'Naranja de Valencia',
    precio: 2.29,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-12',
  },
  {
    _id: 'mandarina-clementina',
    nombre: 'Mandarina Clementina',
    precio: 2.49,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-08',
  },
  {
    _id: 'platano-canario',
    nombre: 'Plátano de Canarias',
    precio: 2.69,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-05',
  },
  {
    _id: 'fresa-huelva',
    nombre: 'Fresa Huelva',
    precio: 3.99,
    unidad: 'kg',
    temporal: false,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-10',
  },
  {
    _id: 'arandano',
    nombre: 'Arándano',
    precio: 9.90,
    unidad: 'kg',
    temporal: false,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-30',
  },
  {
    _id: 'frambuesa',
    nombre: 'Frambuesa',
    precio: 12.50,
    unidad: 'kg',
    temporal: false,
    origen: 'Portugal',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-18',
  },
  {
    _id: 'mora',
    nombre: 'Mora',
    precio: 13.90,
    unidad: 'kg',
    temporal: false,
    origen: 'Portugal',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-21',
  },
  {
    _id: 'aguacate-hass',
    nombre: 'Aguacate Hass',
    precio: 3.95,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-10',
  },
  {
    _id: 'mango',
    nombre: 'Mango',
    precio: 4.50,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-02',
  },
  {
    _id: 'papaya',
    nombre: 'Papaya',
    precio: 4.80,
    unidad: 'kg',
    temporal: false,
    origen: 'Brasil',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-28',
  },
  {
    _id: 'maracuya',
    nombre: 'Maracuyá',
    precio: 8.90,
    unidad: 'kg',
    temporal: false,
    origen: 'Colombia',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-12',
  },
  {
    _id: 'pinya',
    nombre: 'Piña',
    precio: 2.99,
    unidad: 'kg',
    temporal: true,
    origen: 'Costa Rica',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-11',
  },
  {
    _id: 'melon-galia',
    nombre: 'Melón Galia',
    precio: 2.39,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-05',
  },
  {
    _id: 'melon-cantalupo',
    nombre: 'Melón Cantalupo',
    precio: 2.59,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-02',
  },
  {
    _id: 'sandia-rayada',
    nombre: 'Sandía Rayada',
    precio: 1.49,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-01',
  },
  {
    _id: 'pera-conferencia',
    nombre: 'Pera Conferencia',
    precio: 2.25,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-03',
  },
  {
    _id: 'uva-blanca',
    nombre: 'Uva Blanca',
    precio: 3.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-06',
  },
  {
    _id: 'uva-negra',
    nombre: 'Uva Negra',
    precio: 3.40,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-01',
  },
  {
    _id: 'kiwi-verde',
    nombre: 'Kiwi Verde',
    precio: 3.20,
    unidad: 'kg',
    temporal: true,
    origen: 'Italia',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-09',
  },
  {
    _id: 'kiwi-amarillo',
    nombre: 'Kiwi Amarillo',
    precio: 4.40,
    unidad: 'kg',
    temporal: true,
    origen: 'Italia',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-27',
  },
  {
    _id: 'limon',
    nombre: 'Limón',
    precio: 1.89,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-13',
  },
  {
    _id: 'lima',
    nombre: 'Lima',
    precio: 3.99,
    unidad: 'kg',
    temporal: true,
    origen: 'Brasil',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-26',
  },
  {
    _id: 'pomelo-rosa',
    nombre: 'Pomelo Rosa',
    precio: 2.85,
    unidad: 'kg',
    temporal: true,
    origen: 'Turquía',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-07',
  },
  {
    _id: 'coco',
    nombre: 'Coco',
    precio: 2.20,
    unidad: 'pieza',
    temporal: false,
    origen: 'Costa de Marfil',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-08',
  },
  {
    _id: 'granada',
    nombre: 'Granada',
    precio: 2.99,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-04',
  },
  {
    _id: 'caqui',
    nombre: 'Caqui Persimón',
    precio: 2.79,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-14',
  },
  {
    _id: 'chirimoya',
    nombre: 'Chirimoya',
    precio: 5.20,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-15',
  },
  {
    _id: 'melocoton',
    nombre: 'Melocotón',
    precio: 2.60,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-05',
  },
  {
    _id: 'nectarina',
    nombre: 'Nectarina',
    precio: 2.80,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-04',
  },
  {
    _id: 'albaricoque',
    nombre: 'Albaricoque',
    precio: 3.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-07-20',
  },
  {
    _id: 'ciruela-roja',
    nombre: 'Ciruela Roja',
    precio: 2.95,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-08-10',
  },
  {
    _id: 'cereza',
    nombre: 'Cereza',
    precio: 6.90,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-06-05',
  },
  {
    _id: 'higo',
    nombre: 'Higo',
    precio: 5.50,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-01',
  },
  // —— Verduras / IV gama / Hierbas ——
  {
    _id: 'tomate-ensalada',
    nombre: 'Tomate de Ensalada',
    precio: 2.20,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-06',
  },
  {
    _id: 'tomate-pera',
    nombre: 'Tomate Pera',
    precio: 1.95,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-05',
  },
  {
    _id: 'tomate-cherry',
    nombre: 'Tomate Cherry',
    precio: 3.60,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-09',
  },
  {
    _id: 'pepino',
    nombre: 'Pepino',
    precio: 1.45,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-08',
  },
  {
    _id: 'calabacin',
    nombre: 'Calabacín',
    precio: 1.89,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-03',
  },
  {
    _id: 'pimiento-rojo',
    nombre: 'Pimiento Rojo',
    precio: 2.40,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-02',
  },
  {
    _id: 'pimiento-verde',
    nombre: 'Pimiento Verde',
    precio: 2.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-01',
  },
  {
    _id: 'pimiento-amarillo',
    nombre: 'Pimiento Amarillo',
    precio: 2.55,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-29',
  },
  {
    _id: 'cebolla-dulce',
    nombre: 'Cebolla Dulce',
    precio: 1.20,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-06',
  },
  {
    _id: 'cebolla-morada',
    nombre: 'Cebolla Morada',
    precio: 1.50,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-25',
  },
  {
    _id: 'ajo-morado',
    nombre: 'Ajo Morado',
    precio: 3.90,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-10',
  },
  {
    _id: 'patata-agria',
    nombre: 'Patata Agria',
    precio: 0.95,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-11',
  },
  {
    _id: 'zanahoria',
    nombre: 'Zanahoria',
    precio: 1.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-12',
  },
  {
    _id: 'lechuga-romana',
    nombre: 'Lechuga Romana',
    precio: 1.20,
    unidad: 'pieza',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-13',
  },
  {
    _id: 'lechuga-iceberg',
    nombre: 'Lechuga Iceberg',
    precio: 1.15,
    unidad: 'pieza',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-07',
  },
  {
    _id: 'espinaca-bolsa',
    nombre: 'Espinaca (bolsa)',
    precio: 1.60,
    unidad: 'bandeja',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-09',
  },
  {
    _id: 'kale',
    nombre: 'Col Kale',
    precio: 2.30,
    unidad: 'manojo',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-05',
  },
  {
    _id: 'brocoli',
    nombre: 'Brócoli',
    precio: 2.20,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-06',
  },
  {
    _id: 'coliflor',
    nombre: 'Coliflor',
    precio: 2.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-04',
  },
  {
    _id: 'seta-champinon',
    nombre: 'Champiñón',
    precio: 3.40,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-02',
  },
  {
    _id: 'seta-shiitake',
    nombre: 'Seta Shiitake',
    precio: 7.90,
    unidad: 'kg',
    temporal: false,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-09-22',
  },
  {
    _id: 'menta',
    nombre: 'Menta (manojo)',
    precio: 0.99,
    unidad: 'manojo',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-12',
  },
  {
    _id: 'albahaca',
    nombre: 'Albahaca (manojo)',
    precio: 1.20,
    unidad: 'manojo',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-08',
  },
  {
    _id: 'perejil',
    nombre: 'Perejil (manojo)',
    precio: 0.90,
    unidad: 'manojo',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-07',
  },
  {
    _id: 'jengibre',
    nombre: 'Jengibre',
    precio: 4.90,
    unidad: 'kg',
    temporal: true,
    origen: 'Perú',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-03',
  },
  {
    _id: 'nabo',
    nombre: 'Nabo',
    precio: 1.30,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-01',
  },
  {
    _id: 'boniato',
    nombre: 'Boniato',
    precio: 2.10,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-13',
  },
  {
    _id: 'calabaza-violon',
    nombre: 'Calabaza Violin',
    precio: 1.65,
    unidad: 'kg',
    temporal: true,
    origen: 'España',
    ecologico: true,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-14',
  },
  {
    _id: 'apio',
    nombre: 'Apio',
    precio: 1.40,
    unidad: 'manojo',
    temporal: true,
    origen: 'España',
    ecologico: false,
    foto: '/img/frutas/manzana.jpg',
    actualizadoEl: '2025-10-12',
  },
].map((f) => ({ ...f, foto: '/img/frutas/manzana.jpg' }));


// --- Enriquecimiento para el quiz de bienestar/vitaminas ---
// Tipos (ajusta tu interfaz Fruit si quieres tipado estricto)
type Beneficio = 'energia'|'defensas'|'digestion'|'recuperacion'|'suenio'|'hidratacion'|'piel';
type Formato = 'pieza'|'zumo'|'smoothie'|'bowl';
type Momento = 'desayuno'|'pre'|'post'|'noche';
type Restriccion =
  | 'evitar-reflujo'                // cítricos/ácidos pueden molestar
  | 'interaccion-medicacion-pomelo' // pomelo puede interactuar con fármacos
  | 'alergia-latex'                 // posible reacción cruzada (plátano/aguacate…)
  | 'alto-indice-glucemico';        // moderar si se pide “bajo azúcar”

type Nutrientes = {
  vitC_mg?: number;        // aprox por 100g (cuando aplica)
  potasio_mg?: number;     // aprox por 100g
  fibra_g?: number;        // aprox por 100g
  agua_pct?: number;       // %
  carotenoides?: boolean;  // beta-caroteno/provitamina A relevante
  polifenoles?: boolean;   // antocianinas/taninos relevantes
  licopeno?: boolean;      // tomate
  luteina_zeaxantina?: boolean; // hojas verdes
  bromelina?: boolean;     // piña
  papaina?: boolean;       // papaya
  actinidina?: boolean;    // kiwi
  melatonina?: boolean;    // cereza/guinda
  grasas_saludables?: boolean; // aguacate
};

// Familia nutricional para asignar perfiles por defecto
type Familia =
  | 'citrico' | 'berry' | 'tropical-enzima' | 'tropical-dulce'
  | 'melon' | 'pome' | 'uva' | 'platano' | 'granada' | 'stone'
  | 'coco' | 'tomate' | 'pepino' | 'calabacin' | 'pimiento'
  | 'allium' | 'raiz' | 'hoja' | 'crucifera' | 'seta' | 'hierba' | 'otros';

// Perfiles por familia (beneficios “con base” y formatos recomendados)
const FAMILIA_PROFILE: Record<Familia, {
  beneficios: Beneficio[];
  formatosBuenos: Formato[];
  momentoBueno: Momento[];
  restricciones?: Restriccion[];
  nutriHint?: Partial<Nutrientes>;
}> = {
  citrico: {
    beneficios: ['defensas','hidratacion','energia'],
    formatosBuenos: ['pieza','zumo','smoothie'],
    momentoBueno: ['desayuno','pre'],
    restricciones: ['evitar-reflujo'],
    nutriHint: { vitC_mg: 40, agua_pct: 86, polifenoles: true }
  },
  berry: {
    beneficios: ['defensas','piel','recuperacion'],
    formatosBuenos: ['pieza','bowl','smoothie'],
    momentoBueno: ['desayuno','post','noche'],
    nutriHint: { fibra_g: 2, polifenoles: true, vitC_mg: 40, agua_pct: 85 }
  },
  'tropical-enzima': {
    beneficios: ['digestion','recuperacion','defensas'],
    formatosBuenos: ['pieza','zumo','smoothie'],
    momentoBueno: ['post','desayuno'],
    restricciones: ['evitar-reflujo'],
    nutriHint: { agua_pct: 86 }
  },
  'tropical-dulce': {
    beneficios: ['piel','defensas','energia'],
    formatosBuenos: ['pieza','smoothie','bowl'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { carotenoides: true, fibra_g: 2 }
  },
  melon: {
    beneficios: ['hidratacion','piel'],
    formatosBuenos: ['pieza','zumo'],
    momentoBueno: ['pre','post','desayuno'],
    nutriHint: { agua_pct: 90 }
  },
  pome: {
    beneficios: ['digestion','energia','piel'],
    formatosBuenos: ['pieza','zumo','bowl'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { fibra_g: 2, agua_pct: 84 }
  },
  uva: {
    beneficios: ['recuperacion','energia','defensas'],
    formatosBuenos: ['pieza','zumo','bowl'],
    momentoBueno: ['post','desayuno'],
    nutriHint: { polifenoles: true, agua_pct: 81 }
  },
  platano: {
    beneficios: ['energia','recuperacion','suenio'],
    formatosBuenos: ['pieza','smoothie','bowl'],
    momentoBueno: ['pre','post','desayuno'],
    restricciones: ['alergia-latex'],
    nutriHint: { potasio_mg: 360, fibra_g: 2 }
  },
  granada: {
    beneficios: ['defensas','piel','recuperacion'],
    formatosBuenos: ['pieza','zumo','bowl'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { polifenoles: true, agua_pct: 78 }
  },
  stone: { // hueso: melocotón, albaricoque, ciruela, nectarina, caqui, chirimoya, cereza, higo
    beneficios: ['piel','hidratacion','digestion'],
    formatosBuenos: ['pieza','bowl','smoothie'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { carotenoides: true, fibra_g: 2 }
  },
  coco: {
    beneficios: ['energia'],
    formatosBuenos: ['pieza','bowl'],
    momentoBueno: ['post','desayuno'],
    nutriHint: { agua_pct: 47 }
  },
  tomate: {
    beneficios: ['piel','defensas','hidratacion'],
    formatosBuenos: ['pieza','bowl','zumo'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { licopeno: true, vitC_mg: 14, agua_pct: 94 }
  },
  pepino: {
    beneficios: ['hidratacion','digestion'],
    formatosBuenos: ['pieza','bowl','zumo'],
    momentoBueno: ['pre','post','desayuno'],
    nutriHint: { agua_pct: 95 }
  },
  calabacin: {
    beneficios: ['hidratacion','digestion'],
    formatosBuenos: ['bowl','smoothie'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { agua_pct: 94 }
  },
  pimiento: {
    beneficios: ['defensas','piel'],
    formatosBuenos: ['bowl','pieza'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { vitC_mg: 100 }
  },
  allium: {
    beneficios: ['defensas','digestion'],
    formatosBuenos: ['bowl'],
    momentoBueno: ['desayuno','post'],
  },
  raiz: {
    beneficios: ['energia','piel','digestion'],
    formatosBuenos: ['bowl','smoothie'],
    momentoBueno: ['desayuno','post'],
    nutriHint: { carotenoides: true }
  },
  hoja: {
    beneficios: ['piel','defensas','recuperacion'],
    formatosBuenos: ['bowl','smoothie'],
    momentoBueno: ['desayuno','noche'],
    nutriHint: { luteina_zeaxantina: true, agua_pct: 93 }
  },
  crucifera: {
    beneficios: ['defensas','digestion'],
    formatosBuenos: ['bowl'],
    momentoBueno: ['desayuno','post'],
  },
  seta: {
    beneficios: ['recuperacion','defensas'],
    formatosBuenos: ['bowl'],
    momentoBueno: ['noche','post'],
  },
  hierba: {
    beneficios: ['digestion','defensas'],
    formatosBuenos: ['bowl','smoothie'],
    momentoBueno: ['desayuno','noche'],
  },
  otros: {
    beneficios: ['energia'],
    formatosBuenos: ['pieza'],
    momentoBueno: ['desayuno','post'],
  }
};

// Asignación de cada _id a su familia
const ITEM_FAMILIA: Record<string, Familia> = {
  // Fruta
  'manzana.jpg-golden': 'pome',
  'naranja-valencia': 'citrico',
  'mandarina-clementina': 'citrico',
  'platano-canario': 'platano',
  'fresa-huelva': 'berry',
  'arandano': 'berry',
  'frambuesa': 'berry',
  'mora': 'berry',
  'aguacate-hass': 'otros',
  'mango': 'tropical-dulce',
  'papaya': 'tropical-enzima',
  'maracuya': 'tropical-dulce',
  'pinya': 'tropical-enzima',         // piña
  'melon-galia': 'melon',
  'melon-cantalupo': 'melon',
  'sandia-rayada': 'melon',
  'pera-conferencia': 'pome',
  'uva-blanca': 'uva',
  'uva-negra': 'uva',
  'kiwi-verde': 'berry',               // tratamos kiwi como berry funcional
  'kiwi-amarillo': 'berry',
  'limon': 'citrico',
  'lima': 'citrico',
  'pomelo-rosa': 'citrico',
  'coco': 'coco',
  'granada': 'granada',
  'caqui': 'stone',
  'chirimoya': 'stone',
  'melocoton': 'stone',
  'nectarina': 'stone',
  'albaricoque': 'stone',
  'ciruela-roja': 'stone',
  'cereza': 'stone',
  'higo': 'stone',
  // Verdura / hierbas / setas
  'tomate-ensalada': 'tomate',
  'tomate-pera': 'tomate',
  'tomate-cherry': 'tomate',
  'pepino': 'pepino',
  'calabacin': 'calabacin',
  'pimiento-rojo': 'pimiento',
  'pimiento-verde': 'pimiento',
  'pimiento-amarillo': 'pimiento',
  'cebolla-dulce': 'allium',
  'cebolla-morada': 'allium',
  'ajo-morado': 'allium',
  'patata-agria': 'raiz',
  'zanahoria': 'raiz',
  'lechuga-romana': 'hoja',
  'lechuga-iceberg': 'hoja',
  'espinaca-bolsa': 'hoja',
  'kale': 'hoja',
  'brocoli': 'crucifera',
  'coliflor': 'crucifera',
  'seta-champinon': 'seta',
  'seta-shiitake': 'seta',
  'menta': 'hierba',
  'albahaca': 'hierba',
  'perejil': 'hierba',
  'jengibre': 'raiz',
  'nabo': 'raiz',
  'boniato': 'raiz',
  'calabaza-violon': 'raiz',
  'apio': 'hoja',
};

// Overrides específicos (enzimas, melatonina, grasas saludables, pomelo, etc.)
const ITEM_OVERRIDES: Partial<Record<string, {
  beneficios?: Beneficio[];
  restricciones?: Restriccion[];
  nutriHint?: Partial<Nutrientes>;
}>> = {
  'pinya': { nutriHint: { bromelina: true, vitC_mg: 47 } },                 // piña
  'papaya': { nutriHint: { papaina: true, carotenoides: true } },
  'kiwi-verde': { nutriHint: { actinidina: true, vitC_mg: 90 }, beneficios: ['defensas','digestion','suenio'] },
  'kiwi-amarillo': { nutriHint: { actinidina: true, vitC_mg: 110 }, beneficios: ['defensas','digestion'] },
  'cereza': { nutriHint: { melatonina: true, polifenoles: true }, beneficios: ['suenio','recuperacion','defensas'] },
  'pomelo-rosa': { restricciones: ['interaccion-medicacion-pomelo','evitar-reflujo'], nutriHint: { vitC_mg: 37 } },
  'aguacate-hass': { nutriHint: { grasas_saludables: true, fibra_g: 7, potasio_mg: 480 }, beneficios: ['energia','piel','digestion'], restricciones: ['alergia-latex'] },
  'zanahoria': { nutriHint: { carotenoides: true }, beneficios: ['piel','digestion','energia'] },
  'boniato': { nutriHint: { carotenoides: true, fibra_g: 3 }, beneficios: ['energia','piel'] },
  'calabaza-violon': { nutriHint: { carotenoides: true }, beneficios: ['piel','digestion'] },
  'espinaca-bolsa': { nutriHint: { luteina_zeaxantina: true }, beneficios: ['piel','defensas','recuperacion'] },
  'kale': { nutriHint: { luteina_zeaxantina: true }, beneficios: ['piel','defensas','recuperacion'] },
  'brocoli': { beneficios: ['defensas','digestion'] },
  'granada': { nutriHint: { polifenoles: true } },
  'uva-negra': { nutriHint: { polifenoles: true } },
  'uva-blanca': { nutriHint: { polifenoles: true } },
  'tomate-ensalada': { nutriHint: { licopeno: true } },
  'tomate-pera': { nutriHint: { licopeno: true } },
  'tomate-cherry': { nutriHint: { licopeno: true } },
  'jengibre': { beneficios: ['digestion','recuperacion'] },
};

// Temporada en España (aprox). Si falta, usamos todo el año o el flag `temporal`.
const TEMPORADAS: Partial<Record<string, number[]>> = {
  'naranja-valencia': [11,12,1,2,3,4,5],
  'mandarina-clementina': [10,11,12,1,2],
  'limon': [1,2,3,4,5,6,7,8,9,10,11,12],
  'lima': [1,2,3,4,5,6,7,8,9,10,11,12],
  'pomelo-rosa': [11,12,1,2,3,4],
  'platano-canario': [1,2,3,4,5,6,7,8,9,10,11,12],
  'manzana.jpg-golden': [9,10,11,12,1,2,3,4],
  'pera-conferencia': [8,9,10,11,12],
  'uvas-blanca': [8,9,10], // (si tu _id exacto es 'uva-blanca', ignora esta)
  'uva-blanca': [8,9,10],
  'uva-negra': [8,9,10],
  'granada': [9,10,11,12,1],
  'caqui': [10,11,12],
  'chirimoya': [10,11,12,1,2],
  'mango': [9,10,11],
  'papaya': [1,2,3,4,5,6,7,8,9,10,11,12],
  'maracuya': [1,2,3,4,5,6,7,8,9,10,11,12],
  'pinya': [1,2,3,4,5,6,7,8,9,10,11,12],
  'melon-galia': [6,7,8,9],
  'melon-cantalupo': [6,7,8,9],
  'sandia-rayada': [6,7,8,9],
  'fresa-huelva': [2,3,4,5,6],
  'arandano': [5,6,7,8,9],
  'frambuesa': [5,6,7,8,9,10],
  'mora': [6,7,8,9],
  'kiwi-verde': [10,11,12,1,2,3,4,5],
  'kiwi-amarillo': [10,11,12,1,2,3,4],
  'melocoton': [6,7,8,9],
  'nectarina': [6,7,8,9],
  'albaricoque': [5,6,7],
  'ciruela-roja': [6,7,8,9],
  'cereza': [5,6,7],
  'higo': [8,9,10],
  // Verdura: gran parte todo el año, dejamos defaults salvo puntas
};

// Deriva formatos y momentos por defecto si no hay override
const DEFAULT_FORMATOS: Formato[] = ['pieza','bowl','smoothie','zumo'];
const DEFAULT_MOMENTOS: Momento[] = ['desayuno','pre','post','noche'];

// Enriquecedor principal
type FruitQuiz = import('@/lib/types').Fruit & {
  beneficios: Beneficio[];
  formatosBuenos: Formato[];
  momentoBueno: Momento[];
  temporada: number[];
  restricciones: Restriccion[];
  nutrientes: Nutrientes;
};

function enriquecer(f: import('@/lib/types').Fruit): FruitQuiz {
  const familia = ITEM_FAMILIA[f._id] ?? 'otros';
  const base = FAMILIA_PROFILE[familia];
  const override = ITEM_OVERRIDES[f._id] ?? {};

  const beneficios = override.beneficios ?? base.beneficios;
  const formatosBuenos = base.formatosBuenos ?? DEFAULT_FORMATOS;
  const momentoBueno = base.momentoBueno ?? DEFAULT_MOMENTOS;

  // ⬇️ TIPAR el extra evita que se convierta en string[]
  const extraRestricciones: Restriccion[] =
    f._id === 'platano-canario' ? ['alto-indice-glucemico'] : [];

  const restricciones: Restriccion[] = [
    ...(base.restricciones ?? []),
    ...(override.restricciones ?? []),
    ...extraRestricciones,
  ];

  const nutrientes: Nutrientes = { ...(base.nutriHint ?? {}), ...(override.nutriHint ?? {}) };

  let temporada = TEMPORADAS[f._id];
  if (!temporada) {
    temporada = f.temporal ? [3,4,5,6,7,8,9,10] : [1,2,3,4,5,6,7,8,9,10,11,12];
  }

  return { ...f, beneficios, formatosBuenos, momentoBueno, temporada, restricciones, nutrientes };
}

// --- Exporta tu lista enriquecida para el quiz ---
export const FRUTAS_QUIZ: FruitQuiz[] = FRUTAS.map(enriquecer);
